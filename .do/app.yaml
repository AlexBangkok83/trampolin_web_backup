name: trampolin-web
static_sites:
  - name: web
    github:
      repo: BrightOnAnalytics/trampolin-web
      branch: main
      deploy_on_push: true
    build_command: |
      # Install dependencies
      npm ci
      
      # Build the application
      npm run build
      
      # Create necessary directories
      mkdir -p .next/static/_next
      
      # Move static files to the correct location
      cp -r .next/static/* .next/static/_next/
      
      # Clean up
      rm -rf .next/cache
    
    # Output directory for static files
    output_dir: .next/static
    
    # Environment variables
    envs:
      - key: NODE_ENV
        value: production
      - key: NEXT_TELEMETRY_DISABLED
        value: "1"
      - key: STRIPE_SECRET_KEY
        value: ${STRIPE_SECRET_KEY}
      - key: DATABASE_URL
        value: ${DATABASE_URL}
    
    # HTTP settings
    http_port: 8080
    
    # Health check
    health_check:
      http_path: /
      initial_delay_seconds: 30
